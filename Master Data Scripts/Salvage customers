SELECT 'GICT' as DataAreaId,
	Concat('Party-','GICT-',full_name) as PartyNumber,
					case 
	when len(dense_rank() over (order by [full_name])) = 1
		then '2000000' + Cast((dense_rank() over (order by [full_name])) as Nvarchar(10))
	when len(dense_rank() over (order by [full_name])) = 2
		then '200000' + Cast((dense_rank() over (order by [full_name])) as Nvarchar(10))
	when len(dense_rank() over (order by [full_name])) = 3
		then '20000' + Cast((dense_rank() over (order by [full_name])) as Nvarchar(10))
	when len(dense_rank() over (order by [full_name])) = 4
		then '2000' + Cast((dense_rank() over (order by [full_name])) as Nvarchar(10))
	when len(dense_rank() over (order by [full_name])) = 5
		then '200' + Cast((dense_rank() over (order by [full_name])) as Nvarchar(10))
	when len(dense_rank() over (order by [full_name])) = 6
		then '20' + Cast((dense_rank() over (order by [full_name])) as Nvarchar(10))
	when len(dense_rank() over (order by [full_name])) = 7
		then '2' + Cast((dense_rank() over (order by [full_name])) as Nvarchar(10))
	end as customeraccount,
		full_name as OrganizationName
      ,full_name as NameAlias
	    ,'1011' as  CustomerGroupID 
	  ,'AllCust' as AddressBooks
	  ,e_mail as PRIMARYCONTACTEMAIL
	  ,
		case when phone != ''
			then concat(area_code, '-',phone) 
		else ''
		end as PrimaryContactPhone
       ,Concat(Address, ' ', Address2) as addressstreet
	  ,case
		when state = 'on'
			then 'CAN'
		else 'USA' 
	end as AddressCountryRegionId
      ,city as AddressCity
      , case
		when state IN ('ont','CAN')
			then 'on'
		else state
		end  as addressState
      ,zip as AddressZipCode
      ,'Net 30' as PaymentTerms
      ,'USD' as salesCurrencyCode
	  ,'AllStores' as DiscountPriceGroupId --Price Group, to default once configure
      ,0 as onHoldstatus	 ,'en-us' as LanguageId
	  ,date_time as CredManCustomerSince
	  ,full_name as SalesAccountNumber
	  ,'-146000-9999-1-Proj0000'
from [posdatabase].SiriusSQL.dbo.accounts s
where acct_name like 'salvage%'