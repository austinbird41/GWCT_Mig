USE [D365Migration]
GO
/****** Object:  StoredProcedure [dbo].[FixedAssets_GPToD365DB]    Script Date: 3/29/2022 1:00:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER procedure [dbo].[FixedAssets_GPToD365DB]
as

INSERT INTO [dbo].[FixedAssets]
           ([DataAreaId]
           ,[FixedAssetNumber]
           ,[FixedAssetGroup]
           ,[SearchName]
           ,[Name]
           ,[Information1]
           ,[ACQUISITIONPRICE], [ACQUISITIONDate])
		   (
select  
'GICT',
f.assetid, --assetid
fg.[FixedAssetGroupId], --assetgroup TODO mapping
f.ASSETDESC as SearchName --name
,f.ASSETDESC as Name --name
,f.EXTASSETDESC 
,Acquisition_Cost as ACQUISITIONPRICE
,ACQDATE as ACQUISITIONDATE --acquisitiondate
--,concat(trim(STRUCTUREID), '00') --department, need to map to updated values

from gwc.dbo.FA00100 f
join D365Migration.dbo.fixedassetgroup fg
on f.assetclassid = fg.GPFixedAssetGroup
where fg.fixedassetgroupId != ''

union 
select  
'GTS',
f.assetid, --assetid
fg.[FixedAssetGroupId], --assetgroup TODO mapping
f.ASSETDESC as SearchName --name
,f.ASSETDESC as Name --name
,f.EXTASSETDESC 
,Acquisition_Cost as ACQUISITIONPRICE
,ACQDATE as ACQUISITIONDATE --acquisitiondate
--,concat(trim(STRUCTUREID), '00') --department, need to map to updated values

from GSS.dbo.FA00100 f
join D365Migration.dbo.fixedassetgroup fg
on f.assetclassid = fg.GPFixedAssetGroup
where fg.fixedassetgroupId != ''
union 

select  
'Blue',
f.assetid, --assetid
fg.[FixedAssetGroupId], --assetgroup TODO mapping
f.ASSETDESC as SearchName --name
,f.ASSETDESC as Name --name
,f.EXTASSETDESC 
,Acquisition_Cost as ACQUISITIONPRICE
,ACQDATE as ACQUISITIONDATE --acquisitiondate
--,concat(trim(STRUCTUREID), '00') --department, need to map to updated values

from blue.dbo.FA00100 f
join D365Migration.dbo.fixedassetgroup fg
on f.assetclassid = fg.GPFixedAssetGroup
where fg.fixedassetgroupId != ''
union

select  
'GWFD',
f.assetid, --assetid
fg.[FixedAssetGroupId], --assetgroup TODO mapping
f.ASSETDESC as SearchName --name
,f.ASSETDESC as Name --name
,f.EXTASSETDESC 
,Acquisition_Cost as ACQUISITIONPRICE
,ACQDATE as ACQUISITIONDATE --acquisitiondate
--,concat(trim(STRUCTUREID), '00') --department, need to map to updated values

from excel.dbo.FA00100 f
join D365Migration.dbo.fixedassetgroup fg
on f.assetclassid = fg.GPFixedAssetGroup
where fg.fixedassetgroupId != ''
)

