USE [D365Migration]
GO
/****** Object:  StoredProcedure [dbo].[FixedAssets_GPToD365DB]    Script Date: 4/4/2022 11:37:00 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER procedure [dbo].[FixedAssets_GPToD365DB]
as

INSERT INTO [dbo].[FixedAssets]
           ([DataAreaId]
           ,[FixedAssetNumber]
           ,[FixedAssetGroup]
           ,[SearchName]
           ,[Name]
           ,[Information1]
           ,[ACQUISITIONPRICE], [ACQUISITIONDate])
		   (
select  
'GICT',
f.assetid, 
f.ASSETCLASSID, 
f.ASSETDESC as SearchName 
,f.ASSETDESC as Name 
,f.EXTASSETDESC 
,Acquisition_Cost as ACQUISITIONPRICE
,ACQDATE as ACQUISITIONDATE 

from gwc.dbo.FA00100 f
where f.ASSETSTATUS = 1

union 
select  
'GTS',
f.assetid, 
f.ASSETCLASSID, 
f.ASSETDESC as SearchName 
,f.ASSETDESC as Name 
,f.EXTASSETDESC 
,Acquisition_Cost as ACQUISITIONPRICE
,ACQDATE as ACQUISITIONDATE 
from GSS.dbo.FA00100 f
where f.ASSETSTATUS = 1

union 

select  
'Blue',
f.assetid, 
f.ASSETCLASSID, 
f.ASSETDESC as SearchName 
,f.ASSETDESC as Name 
,f.EXTASSETDESC 
,Acquisition_Cost as ACQUISITIONPRICE
,ACQDATE as ACQUISITIONDATE 
from blue.dbo.FA00100 f
where  f.ASSETSTATUS = 1
union

select  
'Excl',
f.assetid,
f.ASSETCLASSID, 
f.ASSETDESC as SearchName 
,f.ASSETDESC as Name 
,f.EXTASSETDESC 
,Acquisition_Cost as ACQUISITIONPRICE
,ACQDATE as ACQUISITIONDATE 
from excel.dbo.FA00100 f
where f.ASSETSTATUS = 1
)

