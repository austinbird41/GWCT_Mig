USE [D365Migration]
GO
/****** Object:  StoredProcedure [dbo].[FixedAssetBooks_GPToD365DB]    Script Date: 4/4/2022 11:35:30 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

ALTER Procedure [dbo].[FixedAssetBooks_GPToD365DB]

as

INSERT INTO [dbo].[FixedAssetBooks]
           ([DataAreaId]
           ,[FixedAssetNumber]
           ,[BookId]
           ,[PostingProfileId]
           ,[DepreciationProfileId]
           ,[DimensionDisplayValue]
           ,[ACQUISITIONPRICE]
           ,[ACQUISITIONDate])

select  
'GICT',
f.assetid as FixedAssetNumber, --assetid
'internal' as BookId, 
'Default' as POSTINGPROFILEID,
 'straightli' as DEPRECIATIONPROFILEID,
 concat('-',trim(f.STRUCTUREID), '00-9999-1-Proj0000') as dimensiondisplayvalue
 ,Acquisition_Cost as ACQUISITIONPRICE
,ACQDATE as ACQUISITIONDATE --acquisitiondate
from gwc.dbo.FA00100 f
where f.ASSETSTATUS = 1

union 

select  
'BLUE',
f.assetid as FixedAssetNumber, --assetid
'internal' as BookId, 
'Default' as POSTINGPROFILEID,
 'straightli' as DEPRECIATIONPROFILEID,
 concat('-',trim(f.STRUCTUREID), '00-9999-1-Proj0000') as dimensiondisplayvalue
 ,Acquisition_Cost as ACQUISITIONPRICE
,ACQDATE as ACQUISITIONDATE --acquisitiondate
from blue.dbo.FA00100 f
where f.ASSETSTATUS = 1

union 

select  
'GTS',
f.assetid as FixedAssetNumber, --assetid
'internal' as BookId, 
'Default' as POSTINGPROFILEID,
 'straightli' as DEPRECIATIONPROFILEID,
 concat('-',trim(f.STRUCTUREID), '00-9999-1-Proj0000') as dimensiondisplayvalue
 ,Acquisition_Cost as ACQUISITIONPRICE
,ACQDATE as ACQUISITIONDATE --acquisitiondate
from gss.dbo.FA00100 f
where f.ASSETSTATUS = 1

union

select  
'Excl',
f.assetid as FixedAssetNumber, --assetid
'internal' as BookId, 
'Default' as POSTINGPROFILEID,
 'straightli' as DEPRECIATIONPROFILEID,
'-616000-9999-1-Proj0000' as dimensiondisplayvalue
 ,Acquisition_Cost as ACQUISITIONPRICE
,ACQDATE as ACQUISITIONDATE --acquisitiondate

from excel.dbo.FA00100 f
where f.ASSETSTATUS = 1


